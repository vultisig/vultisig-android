package com.vultisig.wallet.data.utils

import com.vultisig.wallet.data.common.decodeFunctionArgs
import kotlinx.serialization.json.Json
import kotlinx.serialization.json.JsonArray
import kotlinx.serialization.json.JsonElement
import kotlinx.serialization.json.JsonPrimitive
import org.hamcrest.CoreMatchers
import org.hamcrest.MatcherAssert
import org.junit.Assert.assertEquals
import org.junit.Test
import org.web3j.abi.FunctionReturnDecoder
import org.web3j.abi.datatypes.Address
import org.web3j.abi.datatypes.Type
import org.web3j.abi.datatypes.generated.Uint256
import java.math.BigInteger

class StringExtensionsTest {

    @Test
    fun `decodeFunctionArgs decodes address and uint256 into JSON`() {
        // Arrange
//        val signature ="collect((uint256,address,uint128,uint128))"
        val signature =
            "mintWithSignature((address,address,uint256,address,uint256,string,uint256,uint256,address,uint128,uint128,bytes32),bytes)"

//        val memo =
//        "0xfc6f786500000000000000000000000000000000000000000000000000000000000000010000000000000000000000002731cf69f28a2eed9d0d0e1a3b6399e61be446b000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001"
        val memo =
            "0x98a6e993000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000002000000000000000000000000004838b106fce9647bdf1e7877bf73ce8b0bad5f970000000000000000000000004838b106fce9647bdf1e7877bf73ce8b0bad5f9700000000000000000000000000000000000000000000000000000000000000010000000000000000000000004838b106fce9647bdf1e7877bf73ce8b0bad5f9700000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000180000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000001380000000000000000000000004838b106fce9647bdf1e7877bf73ce8b0bad5f97000000000000000000000000000000000000000000000000000000000000346d00000000000000000000000000000000000000000000000000000000000009e61234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef0000000000000000000000000000000000000000000000000000000000000001310000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000024838000000000000000000000000000000000000000000000000000000000000"

        val result = signature.decodeFunctionArgs(memo)

        MatcherAssert.assertThat(
            result,
            CoreMatchers.`is`("[[address,address,uint256,address,uint256,string,uint256,uint256,address,uint128,uint128,bytes32],bytes]")
        )
    }
}